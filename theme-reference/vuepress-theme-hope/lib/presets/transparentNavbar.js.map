{"version":3,"file":"transparentNavbar.js","sourceRoot":"","sources":["../../src/presets/transparentNavbar.ts"],"names":[],"mappings":"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","sourcesContent":["import { useEventListener, useStyleTag } from \"@vueuse/core\";\nimport { computed, nextTick, onMounted, watch } from \"vue\";\nimport { usePageFrontmatter, useRoute, useRouteLocale } from \"vuepress/client\";\n\nimport \"./transparent-navbar.scss\";\n\nconst BLOG_HOMEPAGE_STYLE = `\\\n.theme-container .vp-page.vp-portfolio-home,\n.theme-container .vp-page.vp-blog-home {\n  padding-top: 0;\n}\n.vp-blog-hero.fullscreen {\n  height: 100vh;\n}\n`;\n\nconst HOMEPAGE_STYLE =\n  BLOG_HOMEPAGE_STYLE +\n  `\\\n.theme-container .vp-project-home {\n  padding-top: 0;\n}\n\n.vp-hero-info-wrapper{\n  padding-top: var(--navbar-height);\n}\n`;\n\nconst COLOR_SELECTORS = [\n  \".vp-navbar\",\n  \".vp-site-name\",\n  \".vp-dropdown-title\",\n  \".vp-dropdown-subtitle\",\n  \".vp-navbar .auto-link\",\n  \".vp-navbar .auto-link.route-link-active\",\n  \".vp-action-link\",\n  \".vp-color-mode-switch\",\n  \".vp-outlook-button\",\n  // search icons\n  \".slimsearch-button\",\n  \".DocSearch-Button\",\n];\n\nconst BACKGROUND_SELECTORS = [\n  \".vp-toggle-navbar-button .vp-top\",\n  \".vp-toggle-navbar-button .vp-middle\",\n  \".vp-toggle-navbar-button .vp-bottom\",\n  \".vp-toggle-sidebar-button .icon\",\n  \".vp-toggle-sidebar-button:before\",\n  \".vp-toggle-sidebar-button:after\",\n];\n\nconst encodeDataURI = (content: string): string =>\n  content\n    .replace(/\"/g, \"'\")\n    .replace(/%/g, \"%25\")\n    .replace(/#/g, \"%23\")\n    .replace(/{/g, \"%7B\")\n    .replace(/}/g, \"%7D\")\n    .replace(/</g, \"%3C\")\n    .replace(/>/g, \"%3E\");\n\nconst getStyle = (color: string, parentSelector = \"\"): string =>\n  `\\\n${COLOR_SELECTORS.map((item) => `${parentSelector} .transparent-navbar ${item}`).join(\",\")} {\n  color: ${color};\n}\n${BACKGROUND_SELECTORS.map((item) => `${parentSelector} .transparent-navbar ${item}`).join(\",\")} {\n  background: ${color};\n}\n\n${parentSelector}.transparent-navbar .dropdown-wrapper .dropdown-title > .arrow {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='${encodeDataURI(\n    color,\n  )}' d='M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z'/%3E%3C/svg%3E\");\n}\n`;\n\nexport interface TransparentNavbarOptions {\n  /**\n   * @default 'blog-homepage'\n   */\n  type?: \"homepage\" | \"blog-homepage\" | \"all\";\n\n  /**\n   * Transparent threshold\n   *\n   * 透明的临界距离\n   *\n   * @default 50\n   */\n  threshold?: number;\n\n  /**\n   * Text color in lightmode\n   *\n   * 浅色模式下字体颜色\n   */\n  light?: string;\n\n  /**\n   * Text color in darkmode\n   *\n   * 深色模式下字体颜色\n   */\n  dark?: string;\n}\n\n/**\n * Transparent navbar if needed\n *\n * 将导航栏设置为透明\n */\nexport const setupTransparentNavbar = ({\n  type,\n  threshold = 50,\n  light,\n  dark,\n}: TransparentNavbarOptions = {}): void => {\n  const route = useRoute();\n  const routeLocale = useRouteLocale();\n  const frontmatter = usePageFrontmatter();\n\n  const shouldTransparent = computed(\n    type === \"all\"\n      ? (): boolean => true\n      : type === \"homepage\"\n        ? (): boolean =>\n            (frontmatter.value.home as boolean | undefined) ??\n            route.path === routeLocale.value\n        : (): boolean =>\n            (frontmatter.value.portfolio as boolean | undefined) ??\n            frontmatter.value.layout === \"BlogHome\",\n  );\n\n  const transparentNavbar = (): void => {\n    if (window.scrollY < threshold && shouldTransparent.value) {\n      document.body.classList.add(\"transparent-navbar\");\n    } else {\n      document.body.classList.remove(\"transparent-navbar\");\n    }\n  };\n\n  useStyleTag(\n    (type === \"homepage\" ? HOMEPAGE_STYLE : BLOG_HOMEPAGE_STYLE) +\n      (light ? getStyle(light, \"\") : \"\") +\n      (dark && light !== dark ? getStyle(dark, '[data-theme=\"dark\"]') : \"\"),\n  );\n  useEventListener(\"scroll\", transparentNavbar);\n\n  watch(\n    () => route.path,\n    () => nextTick().then(transparentNavbar),\n  );\n\n  onMounted(() => {\n    transparentNavbar();\n  });\n};\n"]}