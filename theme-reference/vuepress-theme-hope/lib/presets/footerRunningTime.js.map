{"version":3,"file":"footerRunningTime.js","sourceRoot":"","sources":["../../src/presets/footerRunningTime.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,MAAM,EAAE,MAAM,cAAc,CAAC;AACtC,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,KAAK,CAAC;AACjD,OAAO,EAAE,WAAW,EAAE,cAAc,EAAE,MAAM,iBAAiB,CAAC;AAE9D,MAAM,iBAAiB,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;AAE9C;;;;;;;;;GASG;AACH,MAAM,CAAC,MAAM,sBAAsB,GAAG,CACpC,IAAmB,EACnB,UAAkC;IAChC,GAAG,EAAE,qEAAqE;CAC3E,EACD,eAAe,GAAG,KAAK,EACjB,EAAE;IACR,MAAM,gBAAgB,GAAG,CACvB,IAAI,YAAY,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,CAC7C,CAAC,OAAO,EAAE,CAAC;IACZ,IAAI,YAAY,GAAG,EAAE,CAAC;IAEtB,MAAM,IAAI,GAAG,WAAW,EAAE,CAAC;IAC3B,MAAM,GAAG,GAAG,MAAM,EAAE,CAAC;IACrB,MAAM,WAAW,GAAG,cAAc,EAAE,CAAC;IAErC,MAAM,UAAU,GAAG,QAAQ,CAAC,GAAG,EAAE;QAC/B,MAAM,UAAU,GAAG,GAAG,CAAC,KAAK,CAAC,OAAO,EAAE,GAAG,gBAAgB,CAAC;QAC1D,MAAM,QAAQ,GAAG,IAAI,IAAI,CAAC,UAAU,GAAG,iBAAiB,CAAC,CAAC;QAE1D,OAAO;YACL,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,iBAAiB,CAAC;YAC/C,IAAI,EAAE,QAAQ,CAAC,QAAQ,EAAE;YACzB,MAAM,EAAE,QAAQ,CAAC,UAAU,EAAE;YAC7B,MAAM,EAAE,QAAQ,CAAC,UAAU,EAAE;SAC9B,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACb,KAAK,CACH,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,UAAU,CAAC,KAAK,CAAC,EACzC,GAAG,EAAE;YACH,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC;YAEpD,IAAI,MAAM,EAAE,CAAC;gBACX,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,UAAU,CAAC,KAAK,CAAC;gBACvD,MAAM,UAAU,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,OAAO,CAAC,GAAG,CAAC,CAAC;qBAC5D,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,QAAQ,EAAE,CAAC;qBAC/B,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC;qBACjC,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC,QAAQ,EAAE,CAAC;qBACrC,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;gBAEzC,MAAM,CAAC,SAAS,GAAG,GACjB,eAAe;oBACb,CAAC,CAAC,GAAG,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,OAAO,YAAY,EAAE,EAAE,EAAE,CAAC,MAAM;oBAC9D,CAAC,CAAC,EACN,GAAG,UAAU,EAAE,CAAC;gBAChB,YAAY,GAAG,UAAU,CAAC;YAC5B,CAAC;QACH,CAAC,EACD;YACE,KAAK,EAAE,MAAM;YACb,SAAS,EAAE,IAAI;SAChB,CACF,CAAC;IACJ,CAAC,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["import { useNow } from \"@vueuse/core\";\nimport { computed, onMounted, watch } from \"vue\";\nimport { usePageData, useRouteLocale } from \"vuepress/client\";\n\nconst millisecondPerDay = 1000 * 60 * 60 * 24;\n\n/**\n *\n * @param date - The date to calculate the running time\n * @param locales - The locales of running time, `:day`, `:hour`, `:minute`, `:second` will be replaced by the corresponding value\n * @param [preserveContent=false] - Whether to preserve the original content of the footer\n *\n * @param date - 计算运行时间的日期\n * @param locales - 运行时间的本地化文字， `:day`, `:hour`, `:minute`, `:second` 会被对应的值替换\n * @param [preserveContent=false] - 是否保留页脚的原有内容\n */\nexport const setupRunningTimeFooter = (\n  date: string | Date,\n  locales: Record<string, string> = {\n    \"/\": \"Running time: :day days :hour hours :minute minutes :second seconds\",\n  },\n  preserveContent = false,\n): void => {\n  const initialTimeStamp = (\n    date instanceof Date ? date : new Date(date)\n  ).getTime();\n  let prevTimeText = \"\";\n\n  const page = usePageData();\n  const now = useNow();\n  const routeLocale = useRouteLocale();\n\n  const pastedTime = computed(() => {\n    const passedTime = now.value.getTime() - initialTimeStamp;\n    const restDate = new Date(passedTime % millisecondPerDay);\n\n    return {\n      day: Math.floor(passedTime / millisecondPerDay),\n      hour: restDate.getHours(),\n      minute: restDate.getMinutes(),\n      second: restDate.getSeconds(),\n    };\n  });\n\n  onMounted(() => {\n    watch(\n      () => [page.value.path, pastedTime.value],\n      () => {\n        const footer = document.querySelector(\".vp-footer\");\n\n        if (footer) {\n          const { day, hour, minute, second } = pastedTime.value;\n          const localeText = (locales[routeLocale.value] || locales[\"/\"])\n            .replace(\":day\", day.toString())\n            .replace(\":hour\", hour.toString())\n            .replace(\":minute\", minute.toString())\n            .replace(\":second\", second.toString());\n\n          footer.innerHTML = `${\n            preserveContent\n              ? `${footer.innerHTML.replace(`<br>${prevTimeText}`, \"\")}<br>`\n              : \"\"\n          }${localeText}`;\n          prevTimeText = localeText;\n        }\n      },\n      {\n        flush: \"post\",\n        immediate: true,\n      },\n    );\n  });\n};\n"]}