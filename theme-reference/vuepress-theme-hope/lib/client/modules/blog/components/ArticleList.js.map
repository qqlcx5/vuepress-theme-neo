{"version":3,"file":"ArticleList.js","sourceRoot":"","sources":["../../../../../src/client/modules/blog/components/ArticleList.ts"],"names":[],"mappings":"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","sourcesContent":["import { isSupported, usePageview } from \"@vuepress/plugin-comment/pageview\";\nimport type { PropType, VNode } from \"vue\";\nimport {\n  computed,\n  defineComponent,\n  h,\n  nextTick,\n  onMounted,\n  ref,\n  watch,\n} from \"vue\";\nimport { useRoute, useRouter } from \"vuepress/client\";\n\nimport { DropTransition } from \"@theme-hope/components/transitions/index\";\nimport ArticleItem from \"@theme-hope/modules/blog/components/ArticleItem\";\nimport Pagination from \"@theme-hope/modules/blog/components/Pagination\";\nimport {\n  useBlogLocaleData,\n  useBlogOptions,\n} from \"@theme-hope/modules/blog/composables/index\";\n\nimport type {\n  ArticleInfoData,\n  PageInfoData,\n} from \"../../../../shared/index.js\";\n\nimport \"../styles/article-list.scss\";\n\nexport default defineComponent({\n  name: \"ArticleList\",\n\n  props: {\n    /**\n     * Articles\n     *\n     * 文章项目\n     */\n    items: {\n      type: Array as PropType<\n        { path: string; info: PageInfoData & ArticleInfoData }[]\n      >,\n\n      default: () => [],\n    },\n  },\n\n  setup(props) {\n    const route = useRoute();\n    const router = useRouter();\n    const blogLocale = useBlogLocaleData();\n    const blogOptions = useBlogOptions();\n    const updatePageview = usePageview();\n\n    const currentPage = ref(1);\n\n    const articlePerPage = computed(\n      () => blogOptions.value.articlePerPage ?? 10,\n    );\n\n    const currentArticles = computed(() =>\n      props.items.slice(\n        (currentPage.value - 1) * articlePerPage.value,\n        currentPage.value * articlePerPage.value,\n      ),\n    );\n\n    const updatePage = async (page: number): Promise<void> => {\n      currentPage.value = page;\n\n      const query = { ...route.query };\n\n      const needUpdate = !(\n        query.page === page.toString() || // Page equal as query\n        // Page is 1 and query is empty\n        (page === 1 && !query.page)\n      );\n\n      if (needUpdate) {\n        if (page === 1) delete query.page;\n        else query.page = page.toString();\n\n        await router.push({ path: route.path, query });\n      }\n\n      if (isSupported) {\n        await nextTick();\n        updatePageview({ selector: \".vp-pageview\" });\n      }\n    };\n\n    onMounted(() => {\n      const { page } = route.query;\n\n      void updatePage(page ? Number(page) : 1);\n\n      watch(currentPage, () => {\n        // List top border distance\n        const distance =\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          document.querySelector(\"#article-list\")!.getBoundingClientRect().top +\n          window.scrollY;\n\n        setTimeout(() => {\n          window.scrollTo(0, distance);\n        }, 100);\n      });\n    });\n\n    return (): VNode =>\n      h(\n        \"div\",\n        { id: \"article-list\", class: \"vp-article-list\", role: \"feed\" },\n        currentArticles.value.length\n          ? [\n              ...currentArticles.value.map(({ info, path }, index) =>\n                h(DropTransition, { appear: true, delay: index * 0.04 }, () =>\n                  h(ArticleItem, { key: path, info, path }),\n                ),\n              ),\n              h(Pagination, {\n                current: currentPage.value,\n                perPage: articlePerPage.value,\n                total: props.items.length,\n                onUpdateCurrentPage: updatePage,\n              }),\n            ]\n          : h(\"h2\", { class: \"vp-empty-hint\" }, blogLocale.value.empty),\n      );\n  },\n});\n"]}