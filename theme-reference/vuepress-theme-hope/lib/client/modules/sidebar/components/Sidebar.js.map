{"version":3,"file":"Sidebar.js","sourceRoot":"","sources":["../../../../../src/client/modules/sidebar/components/Sidebar.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,eAAe,EAAE,CAAC,EAAE,SAAS,EAAE,UAAU,EAAE,KAAK,EAAE,MAAM,KAAK,CAAC;AACvE,OAAO,EAAE,QAAQ,EAAE,MAAM,iBAAiB,CAAC;AAE3C,OAAO,YAAY,MAAM,qDAAqD,CAAC;AAC/E,OAAO,EAAE,eAAe,EAAE,MAAM,+CAA+C,CAAC;AAEhF,OAAO,wBAAwB,CAAC;AAEhC,eAAe,eAAe,CAAC;IAC7B,IAAI,EAAE,SAAS;IAEf,KAAK,EAAE,MAIL;IAEF,KAAK,CAAC,MAAM,EAAE,EAAE,KAAK,EAAE;QACrB,MAAM,KAAK,GAAG,QAAQ,EAAE,CAAC;QACzB,MAAM,YAAY,GAAG,eAAe,EAAE,CAAC;QAEvC,MAAM,OAAO,GAAG,UAAU,EAAe,CAAC;QAE1C,SAAS,CAAC,GAAG,EAAE;YACb,gCAAgC;YAChC,KAAK,CACH,GAAG,EAAE,CAAC,KAAK,CAAC,IAAI,EAChB,CAAC,IAAI,EAAQ,EAAE;gBACb,0EAA0E;gBAC1E,MAAM,iBAAiB,GAAG,QAAQ,CAAC,aAAa,CAC9C,uCAAuC,KAAK,CAAC,IAAI,GAAG,IAAI,IAAI,CAC7D,CAAC;gBAEF,IAAI,CAAC,iBAAiB;oBAAE,OAAO;gBAE/B,wCAAwC;gBACxC,MAAM,EAAE,GAAG,EAAE,UAAU,EAAE,MAAM,EAAE,aAAa,EAAE;gBAC9C,oEAAoE;gBACpE,OAAO,CAAC,KAAM,CAAC,qBAAqB,EAAE,CAAC;gBACzC,oDAAoD;gBACpD,MAAM,EAAE,GAAG,EAAE,oBAAoB,EAAE,MAAM,EAAE,uBAAuB,EAAE,GAClE,iBAAiB,CAAC,qBAAqB,EAAE,CAAC;gBAE5C,iEAAiE;gBACjE,IAAI,oBAAoB,GAAG,UAAU;oBACnC,oCAAoC;oBACpC,iBAAiB,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;gBACzC,oEAAoE;qBAC/D,IACH,oBAAoB,GAAG,uBAAuB;oBAC9C,UAAU,GAAG,aAAa;oBAE1B,uCAAuC;oBACvC,iBAAiB,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;YAC5C,CAAC,EACD,EAAE,SAAS,EAAE,IAAI,EAAE,CACpB,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,OAAO,GAAU,EAAE,CACjB,CAAC,CACC,OAAO,EACP;YACE,GAAG,EAAE,OAAO;YACZ,GAAG,EAAE,SAAS;YACd,EAAE,EAAE,SAAS;YACb,KAAK,EAAE,YAAY;YACnB,YAAY,EAAE,EAAE;SACjB,EACD;YACE,KAAK,CAAC,GAAG,EAAE,EAAE;YACb,KAAK,CAAC,OAAO,EAAE,EAAE,IAAI,CAAC,CAAC,YAAY,EAAE,EAAE,MAAM,EAAE,YAAY,CAAC,KAAK,EAAE,CAAC;YACpE,KAAK,CAAC,MAAM,EAAE,EAAE;SACjB,CACF,CAAC;IACN,CAAC;CACF,CAAC,CAAC","sourcesContent":["import type { SlotsType, VNode } from \"vue\";\nimport { defineComponent, h, onMounted, shallowRef, watch } from \"vue\";\nimport { useRoute } from \"vuepress/client\";\n\nimport SidebarLinks from \"@theme-hope/modules/sidebar/components/SidebarLinks\";\nimport { useSidebarItems } from \"@theme-hope/modules/sidebar/composables/index\";\n\nimport \"../styles/sidebar.scss\";\n\nexport default defineComponent({\n  name: \"SideBar\",\n\n  slots: Object as SlotsType<{\n    default?: () => VNode[] | VNode | null;\n    top?: () => VNode[] | VNode | null;\n    bottom?: () => VNode[] | VNode | null;\n  }>,\n\n  setup(_props, { slots }) {\n    const route = useRoute();\n    const sidebarItems = useSidebarItems();\n\n    const sidebar = shallowRef<HTMLElement>();\n\n    onMounted(() => {\n      // Scroll to active sidebar item\n      watch(\n        () => route.hash,\n        (hash): void => {\n          // Get the active sidebar item DOM, whose href equals to the current route\n          const activeSidebarItem = document.querySelector(\n            `.vp-sidebar a.vp-sidebar-link[href=\"${route.path}${hash}\"]`,\n          );\n\n          if (!activeSidebarItem) return;\n\n          // Get the top and height of the sidebar\n          const { top: sidebarTop, height: sidebarHeight } =\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            sidebar.value!.getBoundingClientRect();\n          // Get the top and height of the active sidebar item\n          const { top: activeSidebarItemTop, height: activeSidebarItemHeight } =\n            activeSidebarItem.getBoundingClientRect();\n\n          // When the active sidebar item overflows the top edge of sidebar\n          if (activeSidebarItemTop < sidebarTop)\n            // Scroll to the top edge of sidebar\n            activeSidebarItem.scrollIntoView(true);\n          // When the active sidebar item overflows the bottom edge of sidebar\n          else if (\n            activeSidebarItemTop + activeSidebarItemHeight >\n            sidebarTop + sidebarHeight\n          )\n            // Scroll to the bottom edge of sidebar\n            activeSidebarItem.scrollIntoView(false);\n        },\n        { immediate: true },\n      );\n    });\n\n    return (): VNode =>\n      h(\n        \"aside\",\n        {\n          ref: sidebar,\n          key: \"sidebar\",\n          id: \"sidebar\",\n          class: \"vp-sidebar\",\n          \"vp-sidebar\": \"\",\n        },\n        [\n          slots.top?.(),\n          slots.default?.() ?? h(SidebarLinks, { config: sidebarItems.value }),\n          slots.bottom?.(),\n        ],\n      );\n  },\n});\n"]}