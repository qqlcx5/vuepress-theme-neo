{"version":3,"file":"useNavbarLanguageDropdown.js","sourceRoot":"","sources":["../../../../../src/client/modules/navbar/composables/useNavbarLanguageDropdown.ts"],"names":[],"mappings":"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","sourcesContent":["import { entries, keys, useRoutePaths } from \"@vuepress/helper/client\";\nimport type { ComputedRef } from \"vue\";\nimport { computed } from \"vue\";\nimport {\n  useRoute,\n  useRouteLocale,\n  useSiteData,\n  useSiteLocaleData,\n} from \"vuepress/client\";\n\nimport {\n  useThemeData,\n  useThemeLocaleData,\n} from \"@theme-hope/composables/index\";\n\nimport type { AutoLinkOptions, NavGroup } from \"../../../../shared/index.js\";\n\n/**\n * Get navbar config of select language dropdown\n */\nexport const useNavbarLanguageDropdown =\n  (): ComputedRef<NavGroup<AutoLinkOptions> | null> => {\n    const routePaths = useRoutePaths();\n    const route = useRoute();\n    const routeLocale = useRouteLocale();\n    const siteData = useSiteData();\n    const siteLocale = useSiteLocaleData();\n    const themeData = useThemeData();\n    const themeLocale = useThemeLocaleData();\n\n    return computed(() => {\n      const localePaths = keys(siteData.value.locales);\n      const extraLocales = entries(themeData.value.extraLocales ?? {});\n\n      // Do not display language selection dropdown if there is only one language\n      if (localePaths.length < 2 && !extraLocales.length) return null;\n\n      const { path, fullPath } = route;\n      const { navbarLocales } = themeLocale.value;\n\n      const languageDropdown: NavGroup<AutoLinkOptions> = {\n        text: \"\",\n        ariaLabel: navbarLocales.selectLangAriaLabel,\n        children: [\n          ...localePaths.map((targetLocalePath) => {\n            // Target locale config of this language link\n            const targetSiteLocale =\n              siteData.value.locales[targetLocalePath] ?? {};\n            const targetThemeLocale =\n              themeData.value.locales[targetLocalePath] ?? {};\n            const targetLang = targetSiteLocale.lang;\n\n            const text = targetThemeLocale.navbarLocales.langName;\n            let link;\n\n            // If the target language is current language\n            if (targetLang === siteLocale.value.lang) {\n              // Stay at current link\n              link = fullPath;\n            }\n            // If the target language is not current language\n            else {\n              const targetLocalePage = path.replace(\n                routeLocale.value,\n                targetLocalePath,\n              );\n\n              // try to link to the corresponding page of current page\n              link = routePaths.value.some((item) => item === targetLocalePage)\n                ? // try to keep current hash and query across languages\n                  fullPath.replace(path, targetLocalePage)\n                : // Or fallback to homepage\n                  (targetThemeLocale.home ?? targetLocalePath);\n            }\n\n            return {\n              text,\n              link,\n            };\n          }),\n          ...extraLocales.map(([text, path]) => ({\n            text,\n            link: path.replace(\n              \":route\",\n              route.fullPath.replace(routeLocale.value, \"\"),\n            ),\n          })),\n        ],\n      };\n\n      return languageDropdown;\n    });\n  };\n"]}