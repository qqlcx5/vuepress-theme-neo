{"version":3,"file":"NavbarDropdown.js","sourceRoot":"","sources":["../../../../../src/client/modules/navbar/components/NavbarDropdown.ts"],"names":[],"mappings":"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","sourcesContent":["import type { PropType, SlotsType, VNode } from \"vue\";\nimport {\n  computed,\n  defineComponent,\n  h,\n  ref,\n  resolveComponent,\n  toRef,\n  watch,\n} from \"vue\";\nimport { usePageData } from \"vuepress/client\";\n\nimport AutoLink from \"@theme-hope/components/AutoLink\";\n\nimport type { AutoLinkOptions, NavGroup } from \"../../../../shared/index.js\";\n\nimport \"../styles/navbar-dropdown.scss\";\n\nexport default defineComponent({\n  name: \"NavbarDropdown\",\n\n  props: {\n    /**\n     * Dropdown config\n     *\n     * 下拉列表配置\n     */\n    config: {\n      type: Object as PropType<\n        NavGroup<AutoLinkOptions | NavGroup<AutoLinkOptions>>\n      >,\n\n      required: true,\n    },\n  },\n\n  slots: Object as SlotsType<{\n    title?: () => VNode | VNode[];\n  }>,\n\n  setup(props, { slots }) {\n    const page = usePageData();\n    const config = toRef(props, \"config\");\n\n    const dropdownAriaLabel = computed(\n      () => config.value.ariaLabel ?? config.value.text,\n    );\n\n    const open = ref(false);\n\n    watch(\n      () => page.value.path,\n      () => {\n        open.value = false;\n      },\n    );\n\n    /**\n     * Open the dropdown when user tab and click from keyboard.\n     *\n     * Use event.detail to detect tab and click from keyboard.\n     * The Tab + Click is UIEvent > KeyboardEvent, so the detail is 0.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/UIEvent/detail\n     */\n    const handleDropdown = (event: MouseEvent): void => {\n      const isTriggerByTab = event.detail === 0;\n\n      if (isTriggerByTab) open.value = !open.value;\n    };\n\n    return (): VNode =>\n      h(\"div\", { class: [\"vp-dropdown-wrapper\", { open: open.value }] }, [\n        h(\n          \"button\",\n          {\n            type: \"button\",\n            class: \"vp-dropdown-title\",\n            \"aria-label\": dropdownAriaLabel.value,\n            onClick: handleDropdown,\n          },\n          [\n            slots.title?.() ?? [\n              h(resolveComponent(\"VPIcon\"), { icon: config.value.icon }),\n              props.config.text,\n            ],\n            h(\"span\", { class: \"arrow\" }),\n            h(\n              \"ul\",\n              { class: \"vp-dropdown\" },\n              config.value.children.map((child, index) => {\n                const isLastChild = index === config.value.children.length - 1;\n\n                return h(\n                  \"li\",\n                  { class: \"vp-dropdown-item\" },\n                  \"children\" in child\n                    ? [\n                        h(\n                          \"h4\",\n                          { class: \"vp-dropdown-subtitle\" },\n                          child.link\n                            ? h(AutoLink, {\n                                config: child as AutoLinkOptions,\n                                onFocusout: () => {\n                                  if (\n                                    // No children\n                                    child.children.length === 0 &&\n                                    isLastChild\n                                  )\n                                    open.value = false;\n                                },\n                              })\n                            : child.text,\n                        ),\n                        h(\n                          \"ul\",\n                          { class: \"vp-dropdown-subitems\" },\n                          child.children.map((grandchild, grandIndex) =>\n                            h(\n                              \"li\",\n                              { class: \"vp-dropdown-subitem\" },\n                              h(AutoLink, {\n                                config: grandchild,\n                                onFocusout: () => {\n                                  if (\n                                    // Last item of grandchild\n                                    grandIndex === child.children.length - 1 &&\n                                    isLastChild\n                                  )\n                                    open.value = false;\n                                },\n                              }),\n                            ),\n                          ),\n                        ),\n                      ]\n                    : h(AutoLink, {\n                        config: child,\n                        onFocusout: () => {\n                          if (isLastChild) open.value = false;\n                        },\n                      }),\n                );\n              }),\n            ),\n          ],\n        ),\n      ]);\n  },\n});\n"]}